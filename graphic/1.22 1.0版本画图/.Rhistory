library(ggplot2)
library(svglite)
library(dplyr)
library(rnaturalearth) # 用于获取地图背景
library(sf)            # 用于处理地理空间数据
# --- 2. 定义您的专属SCI期刊风格配色方案 ---
# 将您提供的颜色方案定义为一个命名的向量，方便后续调用
morandi_colors <- c(
purple_dark = "#B6B3D6",
purple_light = "#CFCCE3",
grey_purple = "#D5D3DE",
grey_light = "#D5D1D1",
nude = "#F6DFD6",
peach = "#F8B2A2",
coral = "#F1837A",
pink_dark = "#E9687A"
)
# --- 3. 创建一个可复用的、统一的图形主题 ---
# 这能确保所有图表的风格（如边框、坐标轴、字体）完全一致
theme_sci_journal <- function() {
theme_classic() + # 从一个简洁的经典主题开始
theme(
# 图形边框：添加一个完整的黑色边框
panel.border = element_rect(colour = "black", fill = NA, size = 1),
# 坐标轴刻度：让刻度线朝外
axis.ticks.length = unit(-0.2, "cm"), # 负值使刻度线朝外
axis.ticks = element_line(colour = "black", size = 0.5),
# 坐标轴文字和标题
axis.text = element_text(color = "black", size = 10),
axis.title = element_text(color = "black", size = 12, face = "bold"),
# 图例样式
legend.title = element_text(size = 11, face = "bold"),
legend.text = element_text(size = 10),
legend.position = "top",
# 图形标题
plot.title = element_text(size = 16, face = "bold", hjust = 0.5, margin = margin(b = 15)),
plot.subtitle = element_text(size = 12, hjust = 0.5, margin = margin(b = 15)),
# 为图形周围留出标注空位
plot.margin = margin(1, 1, 1, 1, "cm")
)
}
# !!! 请务必确认这两个文件路径是正确的 !!!
spatial_data_path <- "E:/美赛/2021C/code/MCM2021c/graphic/1.22 1.0版本画图/t1_spatiotemporal_data.csv"
spatial_output_path <- "E:/美赛/2021C/code/MCM2021c/graphic/1.22 1.0版本画图/figure_1_spatiotemporal_map.svg"
# 读取数据
spatial_data <- read.csv(spatial_data_path)
spatial_data$year <- as.factor(spatial_data$year)
# 获取北美地图数据，并设定绘图范围
north_america <- ne_countries(scale = "medium", continent = "North America", returnclass = "sf")
install.packages("rnaturalearthdata")
# 获取北美地图数据，并设定绘图范围
north_america <- ne_countries(scale = "medium", continent = "North America", returnclass = "sf")
coord_limits_x <- c(-125, -121.5)
coord_limits_y <- c(48, 49.5)
# 绘图
ggplot() +
geom_sf(data = north_america, fill = morandi_colors["grey_light"], color = "white") +
geom_point(
data = spatial_data,
aes(x = longitude, y = latitude, color = year),
size = 4,
alpha = 0.7
) +
scale_color_manual(
name = "Detection Year",
values = c("2019" = morandi_colors["coral"], "2020" = morandi_colors["purple_dark"])
) +
coord_sf(xlim = coord_limits_x, ylim = coord_limits_y, expand = FALSE) +
labs(
title = "Spatiotemporal Spread of Confirmed Vespa mandarinia Sightings",
subtitle = "Sightings expanded from 2019 to 2020 in the Pacific Northwest",
x = "Longitude",
y = "Latitude"
) +
theme_sci_journal()
# 保存为SVG格式
ggsave(spatial_output_path, width = 10, height = 8)
print(paste("图1已成功保存到:", spatial_output_path))
# --- 2. 定义全新的、明亮的配色方案 ---
vibrant_colors <- c(
vibrant_blue = "#0077B6",
vibrant_orange = "#F77F00",
map_bg = "#E9ECEF"
)
# --- 3. 更新图形主题：移除了标题和副标题 ---
theme_sci_journal <- function() {
theme_classic() +
theme(
# 移除标题和副标题
plot.title = element_blank(),
plot.subtitle = element_blank(),
# 保持原有的专业风格
panel.border = element_rect(colour = "black", fill = NA, size = 1),
axis.ticks.length = unit(-0.2, "cm"),
axis.ticks = element_line(colour = "black", size = 0.5),
axis.text = element_text(color = "black", size = 10),
axis.title = element_text(color = "black", size = 12, face = "bold"),
legend.title = element_text(size = 11, face = "bold"),
legend.text = element_text(size = 10),
legend.position = "top",
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm") # 调整边距
)
}
# --- 4. 绘制图1：时空分布图 (新配色 & 无标题) ---
# !!! 请务必确认这两个文件路径是正确的 !!!
spatial_data_path <- "E:/美赛/2021C/data/graphic/t1_spatiotemporal_data.csv"
spatial_output_path <- "E:/美赛/2021C/data/graphic/figure_1_spatiotemporal_map_v2.svg"
# 读取数据
spatial_data <- read.csv(spatial_data_path)
spatial_data_path <- "E:/美赛/2021C/code/MCM2021c/graphic/1.22 1.0版本画图/t1_spatiotemporal_data.csv"
spatial_output_path <- "E:/美赛/2021C/code/MCM2021c/graphic/1.22 1.0版本画图/figure_1_spatiotemporal_map.svg"
seasonal_data_path <- "E:/美赛/2021C/code/MCM2021c/graphic/1.22 1.0版本画图/t1_seasonal_trend_data.csv"
seasonal_output_path <- "E:/美赛/2021C/code/MCM2021c/graphic/1.22 1.0版本画图/figure_2_seasonal_trend.svg"
# --- 2. 定义全新的、明亮的配色方案 ---
vibrant_colors <- c(
vibrant_blue = "#0077B6",
vibrant_orange = "#F77F00",
map_bg = "#E9ECEF"
)
# --- 3. 更新图形主题：移除了标题和副标题 ---
theme_sci_journal <- function() {
theme_classic() +
theme(
# 移除标题和副标题
plot.title = element_blank(),
plot.subtitle = element_blank(),
# 保持原有的专业风格
panel.border = element_rect(colour = "black", fill = NA, size = 1),
axis.ticks.length = unit(-0.2, "cm"),
axis.ticks = element_line(colour = "black", size = 0.5),
axis.text = element_text(color = "black", size = 10),
axis.title = element_text(color = "black", size = 12, face = "bold"),
legend.title = element_text(size = 11, face = "bold"),
legend.text = element_text(size = 10),
legend.position = "top",
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm") # 调整边距
)
}
# --- 4. 绘制图1：时空分布图 (新配色 & 无标题) ---
# 读取数据
spatial_data <- read.csv(spatial_data_path)
spatial_data$year <- as.factor(spatial_data$year)
# 获取地图数据
north_america <- ne_countries(scale = "medium", continent = "North America", returnclass = "sf")
coord_limits_x <- c(-125, -121.5)
coord_limits_y <- c(48, 49.5)
# 绘图
ggplot() +
# 使用新的浅灰色背景
geom_sf(data = north_america, fill = vibrant_colors["map_bg"], color = "white") +
geom_point(
data = spatial_data,
aes(x = longitude, y = latitude, color = year),
size = 4,
alpha = 0.8 # 略微增加不透明度，使颜色更实
) +
# 应用新的亮色调色板
scale_color_manual(
name = "Detection Year",
values = c("2019" = vibrant_colors["vibrant_orange"], "2020" = vibrant_colors["vibrant_blue"])
) +
coord_sf(xlim = coord_limits_x, ylim = coord_limits_y, expand = FALSE) +
# 移除了 title 和 subtitle
labs(
x = "Longitude",
y = "Latitude"
) +
theme_sci_journal()
# 保存为新的SVG文件
ggsave(spatial_output_path, width = 10, height = 8)
print(paste("新版图1已成功保存到:", spatial_output_path))
# --- 3. 定义明亮的配色方案 ---
vibrant_colors <- c(
vibrant_blue = "#0077B6",
vibrant_orange = "#F77F00",
map_bg = "#E9ECEF"
)
# --- 4. 定义无标题的图形主题 ---
theme_sci_journal <- function() {
theme_classic() +
theme(
plot.title = element_blank(),
plot.subtitle = element_blank(),
panel.border = element_rect(colour = "black", fill = NA, size = 1),
axis.ticks.length = unit(-0.2, "cm"),
axis.ticks = element_line(colour = "black", size = 0.5),
axis.text = element_text(color = "black", size = 10),
axis.title = element_text(color = "black", size = 12, face = "bold"),
legend.title = element_text(size = 11, face = "bold"),
legend.text = element_text(size = 10),
legend.position = "top",
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm")
)
}
